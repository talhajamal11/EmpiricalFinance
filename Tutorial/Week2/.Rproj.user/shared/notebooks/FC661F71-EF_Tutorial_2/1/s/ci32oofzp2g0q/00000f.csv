"0",""
"0","# SP500"
"0","SP500 <- SP500 %>%"
"0","  group_by(Year = year(date), Month = month(date)) %>%"
"0","  mutate(monthly_return = prod(1 + daily_return) - 1) %>%"
"0","  ungroup() %>%"
"0","  mutate(rolling_monthly_return = rollapply(daily_return + 1,"
"0","      width = 31, FUN = function(x) prod(x) - 1, align = ""right"", fill = NA))"
"0",""
"0",""
"0","SP500 <- na.omit(SP500)"
"0",""
"0","#Other option"
"0","SP500_QNT <- monthlyReturn(SP500_XTS)"
"0",""
"0","#Plotting"
"0","ggplot(SP500, aes(x = date, y = rolling_monthly_return)) +"
"0","  geom_line() +"
"0","  labs(title = ""Monthly Returns of SP500"", "
"0","       x = ""Date"", "
"0","       y = ""Monthly Return"")"
