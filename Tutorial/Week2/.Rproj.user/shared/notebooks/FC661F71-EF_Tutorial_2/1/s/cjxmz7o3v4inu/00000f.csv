"0",""
"0","# SP500"
"0","SP500 <- SP500 %>%"
"0","  group_by(Year = year(date), Month = month(date)) %>%"
"0","  mutate(log_monthly_return = sum(log_daily_return)) %>%"
"0","  ungroup() %>%"
"0","  mutate(rolling_log_monthly_return = rollapply(log_daily_return, width = 31, FUN = function(x) sum(x), align = ""right"", fill = NA))"
"0",""
"0","SP500 <- na.omit(SP500)"
"0",""
"0","#Plotting"
"0","ggplot(SP500, aes(x = date, y = rolling_log_monthly_return)) +"
"0","  geom_line() +"
"0","  labs(title = ""Log Monthly Returns of SP500"", "
"0","       x = ""Date"", "
"0","       y = ""Monthly Return"")"
